#An aid to de-obfuscating PHP malware

Lots of malware that afflicts WordPress, Joomla and other PHP-based
web sites is written in PHP. PHP is an interpreted language, so the
attackers must distribute their malware as source code. Much of the PHP
malware is obfuscated.  This (PHP) program does some limited de-obfuscation
to aid human understanding of the malware.

My gues is that the attackers obfuscate their PHP code for two reasons:

1. To evade simple signature or checksum based malware detection.
2. To attempt to keep website owners from understanding what the malware does.

I base guess no. 1 on the fact that obfuscation methods change rapidly, sometimes
only getting used for a single installation of malware.

I make guess no. 2 because the obfuscation is often just a "visual confusion"
thing, rather than any kind of encryption. Having `assert()` evaluate a single, very
long line of PHP isn't going to fool any algorithm, but the human eye might glide
right past it.

## Usage

## Design

`revphp` is written in PHP, and de-obfuscates PHP, in some kind of philosophical short-circuit.

Uses [PHP-Parser](https://github.com/nikic/PHP-Parser) to create a parse tree from
a source file, then traverses the parse tree. 

## Features

* Replaces strings obfuscated by Base64 (encoding and decoding), Rot13, URL-encoded, reversed
  and some forms of compression.
* It can de-obfuscate strings that are created by composing encoding, decoding, compression and
  other manipulations.
* It can replace function names that are obfuscated by indirection (i.e. `$function($arg1, $arg2...);`),
  or by tricky use of `$_GLOBAL`
* It replaces arguments of functions of special interest (`eval()`, `fopen()`, `preg_replace()`, etc) with de-obfuscated, or otherwise statically determined values.
